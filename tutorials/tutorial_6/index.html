<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" /><link rel="next" title="Tutorial 7: Video analysis" href="../tutorial_7/" /><link rel="prev" title="Tutorial 5: Projects" href="../tutorial_5/" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Tutorial 6: Size and colour reference - phenopype docs</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/twemoji.css?v=2199c511" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=dafe9a71" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../"><div class="brand">phenopype docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/phenopype_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">phenopype docs</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Internal links</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/">Quickstart</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../installation/">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation/python/">1. Installing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/phenopype/">2. Installing phenopype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/text/">3. Choosing a text editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/spyder/">4. Installing Spyder (optional)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/project/">Project class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/pype/">Pype class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/project_labelling/">Project_labelling class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/utility/">Utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/core/">Core modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/video/">Video analysis</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorial_1/">Tutorial 1: A (very) brief python introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_2/">Tutorial 2: Interacting with images in phenopype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_3/">Tutorial 3: The phenopype workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_4/">Tutorial 4: The Pype class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_5/">Tutorial 5: Projects</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Tutorial 6:  Size and colour reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_7/">Tutorial 7: Video analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../templates/">Templates</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Templates</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../templates/detection/">Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/landmarks/">Landmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/gallery/">Gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/various/">Various</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../resources/">Resources</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Resources</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../resources/python/">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/opencv/">OpenCV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/cv/">Computer vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/yaml/">YAML</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../citation/">Citation</a></li>
</ul>

    <ul class="current">
		<p class="caption"><span class="caption-text">External links</span></p>		
		<li class="toctree-l1"><a class="reference external" href="https://www.phenopype.org">Homepage</a></li>
		<li class="toctree-l1"><a class="reference external" href="https://github.com/phenopype/phenopype">Github</a></li>
		<li class="toctree-l1"><a class="reference external" href="https://www.phenopype.org/gallery/">Gallery</a></li>
		<li class="toctree-l1"><a class="reference external" href="https://www.luerig.net/">Author (luerig.net)</a></li>
	</ul>
</div>

</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/tutorials/tutorial_6.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="tutorial-6-size-and-colour-reference">
<h1>Tutorial 6:  Size and colour reference<a class="headerlink" href="#tutorial-6-size-and-colour-reference" title="Link to this heading">¶</a></h1>
<p>Unless images are taken in a highly standardized environment, e.g. via a scanner or a microscope, variation will be introduced in terms of exposure or distance between camera and photographed object, zooming, etc. To compensate this variation among images within and across datasets, Phenopype contains some preprocessing tools that can automatically correct images.</p>
<div class="alert alert-block alert-info">
<div class="admonition seealso">
<p class="admonition-title" > See also:</p>
<p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.phenopype.org/docs/api/project/">phenopype docs: Project-API</a></p></li>
<li><p><a class="reference external" href="https://www.phenopype.org/docs/api/core/#phenopype.core.preprocessing.detect_reference">phenopype docs: preprocessing-API</a></p></li>
</ul>
</p>
</div>
</div>
<section id="load-project">
<h2>Load project<a class="headerlink" href="#load-project" title="Link to this heading">¶</a></h2>
<p>We will use the project we created before in <a class="reference internal" href="../tutorial_4/"><span class="std std-doc">Tutorial 5</span></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">phenopype</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\mluerig\Downloads\phenopype-tutorials-main&quot;</span><span class="p">)</span>

<span class="n">myproj</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;tutorial_project&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--------------------------------------------
Found existing project root directory - loading from:
C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project

Project &quot;tutorial_project&quot; successfully loaded with 3 images
--------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>First we will need to select and measure the pixel-ratio in a reference image, to which we want to match all images in the project.</p>
</section>
<section id="adding-a-reference-to-the-project">
<h2>Adding a reference to the project<a class="headerlink" href="#adding-a-reference-to-the-project" title="Link to this heading">¶</a></h2>
<p>With the class method <code class="docutils literal notranslate"><span class="pre">add_reference</span></code> we can set a project specific scale by measuring the pixel-ratio in a reference image. The steps for this are:</p>
<ol class="arabic simple">
<li><p>Click on two points with a known distance, e.g. on a piece of mm-paper that you put in the image, and hit <code class="docutils literal notranslate"><span class="pre">Enter</span></code>.</p></li>
<li><p>Enter the length that will be used to calculate the  pixel-ratio.</p></li>
<li><p>Mark the boundaries of the reference card to create a template for automatic scale detection that is saved on the project’s root directory (in the template folder).</p></li>
</ol>
<br>
<center>
<div style="text-align: center; width: 600px;" >
<img src="_figures/scale.gif" style="height: auto; max-width: 100%;">
</div>
<div style="text-align: left; width: 600px;" >
<p><strong>Fig 1</strong> The reference image can be any image, but choose it carefully: if you plan on doing brightness and colour corrections, it should be in the middle of the distribution of all exposures and colours so corrections will not over-expose or over-saturate the images.</p>
</div>
</center>
<p>We will use the image <code class="docutils literal notranslate"><span class="pre">stickleback_side.jpg</span></code> from the <code class="docutils literal notranslate"><span class="pre">image</span></code> folder in <code class="docutils literal notranslate"><span class="pre">tutorials</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myproj</span><span class="o">.</span><span class="n">add_reference</span><span class="p">(</span>
    <span class="n">reference_image_path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;tutorials/data/stickleback_side.jpg&quot;</span><span class="p">,</span> 
    <span class="n">reference_tag</span><span class="o">=</span><span class="s2">&quot;scale1&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reference image not saved, file already exists - use &quot;overwrite==True&quot; or chose different name.
setting active global project reference to &quot;scale1&quot; for 0__stickle1 (active=True)
setting active global project reference to &quot;scale1&quot; for 0__stickle2 (active=True)
setting active global project reference to &quot;scale1&quot; for 0__stickle3 (active=True)
</pre></div>
</div>
</div>
</div>
<p>We are now all set to automatically detect the reference card in our images.</p>
</section>
<section id="detecting-a-reference">
<h2>Detecting a reference<a class="headerlink" href="#detecting-a-reference" title="Link to this heading">¶</a></h2>
<p>To detect the reference template in our images, we need the function <code class="docutils literal notranslate"><span class="pre">detect_reference</span></code> from the <code class="docutils literal notranslate"><span class="pre">preprocessing</span></code> module. To do so on the existing project, we will use the <code class="docutils literal notranslate"><span class="pre">edit_config</span></code> method that was demonstrated in <a class="reference internal" href="../tutorial_5/#Modify-configurations-in-all-subdirectories"><span class="std std-ref">Tutorial 5</span></a>. Again, we want to modify the config in two places: first in the preprocessing chunk, to perform the actual reference detection, and then in the visualization chunk, to show the outline of the detected reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## modify the &quot;preprocessing&quot; section</span>

<span class="n">target1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;    - preprocessing:&quot;&quot;&quot;</span>
<span class="n">replacement1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;    - preprocessing:</span>
<span class="s2">        - detect_reference&quot;&quot;&quot;</span>
    
<span class="n">myproj</span><span class="o">.</span><span class="n">edit_config</span><span class="p">(</span>
    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;plates-v1&quot;</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="n">target1</span><span class="p">,</span>
    <span class="n">replacement</span><span class="o">=</span><span class="n">replacement1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># phenopype quickstart template
# -----------------------------
# This template is intended to go with the phenopype quickstart materials 
# - for details see https://www.phenopype.org/docs/quickstart/ and refer to
# Figure 2 in Luerig 2021 (https://doi.org/10.1111/2041-210X.13771) or 
# phenopype tutorial 3 (https://www.phenopype.org/docs/tutorials/tutorial_3).
# For a better job of measuring individual plate area see the phenopype 
# gallery (https://www.phenopype.org/gallery/example_5/).

config_info:
    config_name: pype_config_plates-v1.yaml
    date_created: &#39;2022-05-06 15:04:33&#39;
    date_last_modified:
    template_name: quickstart-template.yaml
    template_path: C:\Users\mluerig\Downloads\phenopype-quickstart-main\quickstart-template.yaml
processing_steps:
    - preprocessing:
        - detect_reference
        - create_mask:
            ANNOTATION: {type: mask, id: a, edit: false}
            tool: polygon
            label: plates
        - blur:
            kernel_size: 9
    - segmentation:
        - threshold:
            method: adaptive
            blocksize: 99
            constant: 5
        - detect_contour:
            ANNOTATION: {type: contour, id: a, edit: overwrite}
            retrieval: ext
            min_area: 150
    - measurement:
        - compute_shape_features:
            ANNOTATION: {type: shape_features, id: a, edit: overwrite}
    - visualization:
        - select_canvas:
            canvas: raw
        - draw_contour
        - draw_mask:
            label: true
    - export:
        - save_canvas
        - save_annotation:
            overwrite: true

This is what the new config may look like (can differ beteeen files) - proceed?y
New config saved for 0__stickle1
New config saved for 0__stickle2
New config saved for 0__stickle3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## &quot;visualization&quot; modification to add `draw_reference`:</span>

<span class="n">target2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;- draw_mask:</span>
<span class="s2">            label: true&quot;&quot;&quot;</span>
<span class="n">replacement2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;- draw_mask:</span>
<span class="s2">            label: true</span>
<span class="s2">        - draw_reference:</span>
<span class="s2">            line_colour: aqua</span>
<span class="s2">            line_width: 10</span>
<span class="s2">            scale: true&quot;&quot;&quot;</span>
    
<span class="n">myproj</span><span class="o">.</span><span class="n">edit_config</span><span class="p">(</span>
    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;plates-v1&quot;</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="n">target2</span><span class="p">,</span>
    <span class="n">replacement</span><span class="o">=</span><span class="n">replacement2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># phenopype quickstart template
# -----------------------------
# This template is intended to go with the phenopype quickstart materials 
# - for details see https://www.phenopype.org/docs/quickstart/ and refer to
# Figure 2 in Luerig 2021 (https://doi.org/10.1111/2041-210X.13771) or 
# phenopype tutorial 3 (https://www.phenopype.org/docs/tutorials/tutorial_3).
# For a better job of measuring individual plate area see the phenopype 
# gallery (https://www.phenopype.org/gallery/example_5/).

config_info:
    config_name: pype_config_plates-v1.yaml
    date_created: &#39;2022-05-06 15:04:33&#39;
    date_last_modified:
    template_name: quickstart-template.yaml
    template_path: C:\Users\mluerig\Downloads\phenopype-quickstart-main\quickstart-template.yaml
processing_steps:
    - preprocessing:
        - detect_reference
        - create_mask:
            ANNOTATION: {type: mask, id: a, edit: false}
            tool: polygon
            label: plates
        - blur:
            kernel_size: 9
    - segmentation:
        - threshold:
            method: adaptive
            blocksize: 99
            constant: 5
        - detect_contour:
            ANNOTATION: {type: contour, id: a, edit: overwrite}
            retrieval: ext
            min_area: 150
    - measurement:
        - compute_shape_features:
            ANNOTATION: {type: shape_features, id: a, edit: overwrite}
    - visualization:
        - select_canvas:
            canvas: raw
        - draw_contour
        - draw_mask:
            label: true
        - draw_reference:
            line_colour: aqua
            line_width: 10
            scale: true
    - export:
        - save_canvas
        - save_annotation:
            overwrite: true

This is what the new config may look like (can differ beteeen files) - proceed?y
New config saved for 0__stickle1
New config saved for 0__stickle2
New config saved for 0__stickle3
</pre></div>
</div>
</div>
</div>
<p>Now we run our loop with the new <code class="docutils literal notranslate"><span class="pre">pype</span></code> configuration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">myproj</span><span class="o">.</span><span class="n">dir_paths</span><span class="p">:</span>
    <span class="n">pp</span><span class="o">.</span><span class="n">Pype</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;plates-v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- no annotation_type selected - returning all annotations

AUTOLOAD
- annotations loaded:
{
&quot;mask&quot;: [&quot;a&quot;],
&quot;contour&quot;: [&quot;a&quot;],
&quot;shape_features&quot;: [&quot;a&quot;],
&quot;reference&quot;: [&quot;a&quot;]
}
- reference template image loaded from root directory
Stage: add annotation control args
Updating pype config: applying staged changes


------------+++ new pype iteration 2022-05-06 15:08:46 +++--------------




PREPROCESSING
detect_reference
- loaded existing annotation of type &quot;reference&quot; with ID &quot;a&quot;: skipping (edit=False)
create_mask
- loaded existing annotation of type &quot;mask&quot; with ID &quot;a&quot;: skipping (edit=False)
blur


SEGMENTATION
threshold
- multichannel image supplied, converting to grayscale
- decompose image: using gray channel
- including pixels from 1 drawn masks 
- excluding pixels from reference
detect_contour
- loaded existing annotation of type &quot;contour&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)
- found 16 contours that match criteria


MEASUREMENT
compute_shape_features
- loaded existing annotation of type &quot;shape_features&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)


VISUALIZATION
select_canvas
- raw image
draw_contour
draw_mask
draw_reference


EXPORT
save_canvas
- image saved under C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\data\0__stickle1\canvas_plates-v1.jpg (overwritten).
save_annotation
- loading existing annotation file
- no annotation_type selected - exporting all annotations
- updating annotations of type &quot;mask&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;contour&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;shape_features&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;reference&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------


AUTOSHOW


------------+++ new pype iteration 2022-05-06 15:08:52 +++--------------




PREPROCESSING
detect_reference
- loaded existing annotation of type &quot;reference&quot; with ID &quot;a&quot;: skipping (edit=False)
create_mask
- loaded existing annotation of type &quot;mask&quot; with ID &quot;a&quot;: skipping (edit=False)
blur


SEGMENTATION
threshold
- multichannel image supplied, converting to grayscale
- decompose image: using gray channel
- including pixels from 1 drawn masks 
- excluding pixels from reference
detect_contour
- loaded existing annotation of type &quot;contour&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)
- found 16 contours that match criteria


MEASUREMENT
compute_shape_features
- loaded existing annotation of type &quot;shape_features&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)


VISUALIZATION
select_canvas
- raw image
draw_contour
draw_mask
draw_reference


EXPORT
save_canvas
- image saved under C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\data\0__stickle1\canvas_plates-v1.jpg (overwritten).
save_annotation
- loading existing annotation file
- no annotation_type selected - exporting all annotations
- updating annotations of type &quot;mask&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;contour&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;shape_features&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;reference&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------


AUTOSHOW


TERMINATE

AUTOSAVE
- nothing to autosave
- no annotation_type selected - returning all annotations

AUTOLOAD
- annotations loaded:
{
&quot;mask&quot;: [&quot;a&quot;],
&quot;contour&quot;: [&quot;a&quot;],
&quot;shape_features&quot;: [&quot;a&quot;]
}
- reference template image loaded from root directory
Stage: add annotation control args
Updating pype config: applying staged changes


------------+++ new pype iteration 2022-05-06 15:08:54 +++--------------




PREPROCESSING
detect_reference
---------------------------------------------------
Reference card found with 226 keypoint matches:
template image has 36.44 pixel per mm.
current image has 35.21 pixel per mm.
= 96.626 %% of template image.
---------------------------------------------------
create_mask
- loaded existing annotation of type &quot;mask&quot; with ID &quot;a&quot;: skipping (edit=False)
blur


SEGMENTATION
threshold
- multichannel image supplied, converting to grayscale
- decompose image: using gray channel
- including pixels from 1 drawn masks 
- excluding pixels from reference
detect_contour
- loaded existing annotation of type &quot;contour&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)
- found 9 contours that match criteria


MEASUREMENT
compute_shape_features
- loaded existing annotation of type &quot;shape_features&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)


VISUALIZATION
select_canvas
- raw image
draw_contour
draw_mask
draw_reference


EXPORT
save_canvas
- image saved under C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\data\0__stickle2\canvas_plates-v1.jpg (overwritten).
save_annotation
- loading existing annotation file
- no annotation_type selected - exporting all annotations
- updating annotations of type &quot;mask&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;contour&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;shape_features&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- writing annotations of type &quot;reference&quot; with id &quot;a&quot; to &quot;annotations_plates-v1.json&quot;


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------


AUTOSHOW


TERMINATE

AUTOSAVE
- nothing to autosave
- no annotation_type selected - returning all annotations

AUTOLOAD
- annotations loaded:
{
&quot;mask&quot;: [&quot;a&quot;],
&quot;contour&quot;: [&quot;a&quot;],
&quot;shape_features&quot;: [&quot;a&quot;]
}
- reference template image loaded from root directory
Stage: add annotation control args
Updating pype config: applying staged changes


------------+++ new pype iteration 2022-05-06 15:08:56 +++--------------




PREPROCESSING
detect_reference
---------------------------------------------------
Reference card found with 254 keypoint matches:
template image has 36.44 pixel per mm.
current image has 35.264 pixel per mm.
= 96.772 %% of template image.
---------------------------------------------------
create_mask
- loaded existing annotation of type &quot;mask&quot; with ID &quot;a&quot;: skipping (edit=False)
blur


SEGMENTATION
threshold
- multichannel image supplied, converting to grayscale
- decompose image: using gray channel
- including pixels from 1 drawn masks 
- excluding pixels from reference
detect_contour
- loaded existing annotation of type &quot;contour&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)
- found 10 contours that match criteria


MEASUREMENT
compute_shape_features
- loaded existing annotation of type &quot;shape_features&quot; with ID &quot;a&quot;: overwriting (edit=overwrite)


VISUALIZATION
select_canvas
- raw image
draw_contour
draw_mask
draw_reference


EXPORT
save_canvas
- image saved under C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\data\0__stickle3\canvas_plates-v1.jpg (overwritten).
save_annotation
- loading existing annotation file
- no annotation_type selected - exporting all annotations
- updating annotations of type &quot;mask&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;contour&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- updating annotations of type &quot;shape_features&quot; with id &quot;a&quot; in &quot;annotations_plates-v1.json&quot; (overwrite=&quot;entry&quot;)
- writing annotations of type &quot;reference&quot; with id &quot;a&quot; to &quot;annotations_plates-v1.json&quot;


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------


AUTOSHOW


TERMINATE

AUTOSAVE
- nothing to autosave
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myproj</span><span class="o">.</span><span class="n">collect_results</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s2">&quot;plates-v1&quot;</span><span class="p">,</span>          
                       <span class="n">files</span><span class="o">=</span><span class="s2">&quot;canvas&quot;</span><span class="p">,</span> <span class="c1"># </span>
                       <span class="n">folder</span><span class="o">=</span><span class="s2">&quot;canvas-v1&quot;</span><span class="p">,</span>
                       <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Created C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\results\canvas-v1
Search string: [&#39;canvas_plates-v1&#39;]
Collected canvas_plates-v1.jpg from 0__stickle1
0__stickle1_canvas_plates-v1.jpg saved under C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\results\canvas-v1\0__stickle1_canvas_plates-v1.jpg.
Collected canvas_plates-v1.jpg from 0__stickle2
0__stickle2_canvas_plates-v1.jpg saved under C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\results\canvas-v1\0__stickle2_canvas_plates-v1.jpg.
Collected canvas_plates-v1.jpg from 0__stickle3
0__stickle3_canvas_plates-v1.jpg saved under C:\Users\mluerig\Downloads\phenopype-tutorials-main\tutorial_project\results\canvas-v1\0__stickle3_canvas_plates-v1.jpg.
</pre></div>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../tutorial_7/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorial 7: Video analysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../tutorial_5/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorial 5: Projects</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Moritz Lürig
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2024-07-03 18:34:04</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorial 6:  Size and colour reference</a><ul>
<li><a class="reference internal" href="#load-project">Load project</a></li>
<li><a class="reference internal" href="#adding-a-reference-to-the-project">Adding a reference to the project</a></li>
<li><a class="reference internal" href="#detecting-a-reference">Detecting a reference</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=fceb765d"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="https://unpkg.com/twemoji@latest/dist/twemoji.min.js"></script>
    <script src="../../_static/twemoji.js?v=a4381b3f"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/custom.js?v=07e4e0e4"></script>
    <script src="https://cdn.jsdelivr.net/gh/mluerig/website-assets/assets/js/enforce_trailing_slash.min.js"></script>
    </body>
</html>